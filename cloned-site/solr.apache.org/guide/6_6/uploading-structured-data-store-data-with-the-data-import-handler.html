<!DOCTYPE html>

<!-- Mirrored from solr.apache.org/guide/6_6/uploading-structured-data-store-data-with-the-data-import-handler.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 26 Feb 2026 00:40:00 GMT -->
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">

<title>Uploading Structured Data Store Data with the Data Import Handler | Apache Solr Reference Guide 6.6</title>
<link rel="canonical" href="https://solr.apache.org/guide/8_11/uploading-structured-data-store-data-with-the-data-import-handler.html">
<meta name="robots" content="noindex">
<link href="https://solr.apache.org/guide/6_6/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="https://solr.apache.org/guide/6_6/css/lavish-bootstrap.css">
<link rel="stylesheet" href="https://solr.apache.org/guide/6_6/css/customstyles.css">
<link rel="stylesheet" href="https://solr.apache.org/guide/6_6/css/theme-solr.css">
<link rel="stylesheet" href="https://solr.apache.org/guide/6_6/css/ref-guide.css">
<link rel="stylesheet" href="https://solr.apache.org/guide/6_6/css/comments.css">

<script src="https://solr.apache.org/guide/6_6/js/jquery-2.1.4.min.js"></script>
<script src="https://solr.apache.org/guide/6_6/js/jquery.cookie-1.4.1.min.js"></script>
<script src="https://solr.apache.org/guide/6_6/js/jquery.navgoco.min.js"></script>

<script src="https://solr.apache.org/guide/6_6/js/bootstrap-3.3.4.min.js"></script>
<script src="https://solr.apache.org/guide/6_6/js/anchor-2.0.0.min.js"></script>
<script src="https://solr.apache.org/guide/6_6/js/toc.js"></script>
<script src="https://solr.apache.org/guide/6_6/js/customscripts.js"></script>

<link rel="shortcut icon" href="https://solr.apache.org/guide/6_6/images/icons/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="js/html5shiv-3.7.0.js"></script>
<script src="js/respond-1.4.2.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="Apache Solr Reference Guide" href="https://home.apache.org/~ctargett/RefGuidePOC/jekyll-full/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // we do *NOT* want cookies used to save the current stage of the sidebar
                             // instead the code in sidebar.html will ensure that the current page
                             // (and it's ancestors) are "active" on page load
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
</head>
<body class="" id="uploading-structured-data-store-data-with-the-data-import-handler">
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
            <a class="fa fa-home fa-lg navbar-brand" href="https://solr.apache.org/guide/6_6/index.html">&nbsp;<span class="projectTitle"> Solr Ref Guide 6.6</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- Link to Solr website -->
                <li><a href="https://lucene.apache.org/solr/" target="_blank">Solr Website</a></li>
                <!-- Other Guide Formats dropdown -->
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other Formats<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                       <li><a href="https://www.apache.org/dyn/closer.cgi/lucene/solr/ref-guide" target="_blank">PDF for Latest Release</a></li>
                       <li><a href="https://archive.apache.org/dist/lucene/solr/ref-guide/" target="_blank">Archived PDFs</a></li>
                       <li><a href="https://lucene.apache.org/solr/guide/" target="_blank">Other Versions Online</a></li>
                    </ul>
                </li>
                <!-- Solr Resources dropdown -->
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Solr Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                       <li><a href="https://lucene.apache.org/solr/6_6_0//solr-core/index.html" target="_blank">Solr Javadocs</a></li>
                       <li><a href="https://lucene.apache.org/solr/community.html#version-control" target="_blank">Lucene/Solr Source Code</a></li>
                       <li><a href="https://lucene.apache.org/solr/community.html" target="_blank">Solr Community Links</a></li>
                    </ul>
                </li>
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="https://solr.apache.org/guide/6_6/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Uploading Structured Data Store Data with the Data Import Handler">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div class="col-lg-12">&nbsp;</div>
  <!-- Content Row -->
  <div class="row">
    <!-- Sidebar Column -->
    <div class="col-md-3">
      

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Apache Solr Reference Guide</li>
  
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/about-this-guide.html">About This Guide</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/getting-started.html">Getting Started</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/installing-solr.html">Installing Solr</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/running-solr.html">Running Solr</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/a-quick-overview.html">A Quick Overview</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/a-step-closer.html">A Step Closer</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/solr-control-script-reference.html">Solr Control Script Reference</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/upgrading-solr.html">Upgrading Solr</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/using-the-solr-administration-user-interface.html">Using the Solr Administration User Interface</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/overview-of-the-solr-admin-ui.html">Overview of the Solr Admin UI</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/getting-assistance.html">Getting Assistance</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/logging.html">Logging</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/cloud-screens.html">Cloud Screens</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/collections-core-admin.html">Collections / Core Admin</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/java-properties.html">Java Properties</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/thread-dump.html">Thread Dump</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/collection-specific-tools.html">Collection-Specific Tools</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/analysis-screen.html">Analysis Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/dataimport-screen.html">Dataimport Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/documents-screen.html">Documents Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/files-screen.html">Files Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/query-screen.html">Query Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/stream-screen.html">Stream Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/schema-browser-screen.html">Schema Browser Screen</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/core-specific-tools.html">Core-Specific Tools</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/ping.html">Ping</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/plugins-stats-screen.html">Plugins &amp; Stats Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/replication-screen.html">Replication Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/segments-info.html">Segments Info</a>
            
          </li>
          
        </ul>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/documents-fields-and-schema-design.html">Documents, Fields, and Schema Design</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/overview-of-documents-fields-and-schema-design.html">Overview of Documents, Fields, and Schema Design</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/solr-field-types.html">Solr Field Types</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/field-type-definitions-and-properties.html">Field Type Definitions and Properties</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/field-types-included-with-solr.html">Field Types Included with Solr</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/working-with-currencies-and-exchange-rates.html">Working with Currencies and Exchange Rates</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/working-with-dates.html">Working with Dates</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/working-with-enum-fields.html">Working with Enum Fields</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/working-with-external-files-and-processes.html">Working with External Files and Processes</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/field-properties-by-use-case.html">Field Properties by Use Case</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/defining-fields.html">Defining Fields</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/copying-fields.html">Copying Fields</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/dynamic-fields.html">Dynamic Fields</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/other-schema-elements.html">Other Schema Elements</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/schema-api.html">Schema API</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/putting-the-pieces-together.html">Putting the Pieces Together</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/docvalues.html">DocValues</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/schemaless-mode.html">Schemaless Mode</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/understanding-analyzers-tokenizers-and-filters.html">Understanding Analyzers, Tokenizers, and Filters</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/analyzers.html">Analyzers</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/about-tokenizers.html">About Tokenizers</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/about-filters.html">About Filters</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/tokenizers.html">Tokenizers</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/filter-descriptions.html">Filter Descriptions</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/charfilterfactories.html">CharFilterFactories</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/language-analysis.html">Language Analysis</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/phonetic-matching.html">Phonetic Matching</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/running-your-analyzer.html">Running Your Analyzer</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/indexing-and-basic-data-operations.html">Indexing and Basic Data Operations</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/introduction-to-solr-indexing.html">Introduction to Solr Indexing</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/post-tool.html">Post Tool</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/uploading-data-with-index-handlers.html">Uploading Data with Index Handlers</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/transforming-and-indexing-custom-json.html">Transforming and Indexing Custom JSON</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/uploading-data-with-solr-cell-using-apache-tika.html">Uploading Data with Solr Cell using Apache Tika</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/uploading-structured-data-store-data-with-the-data-import-handler.html">Uploading Structured Data Store Data with the Data Import Handler</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/updating-parts-of-documents.html">Updating Parts of Documents</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/detecting-languages-during-indexing.html">Detecting Languages During Indexing</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/de-duplication.html">De-Duplication</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/content-streams.html">Content Streams</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/uima-integration.html">UIMA Integration</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/searching.html">Searching</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/overview-of-searching-in-solr.html">Overview of Searching in Solr</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/velocity-search-ui.html">Velocity Search UI</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/relevance.html">Relevance</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/query-syntax-and-parsing.html">Query Syntax and Parsing</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/common-query-parameters.html">Common Query Parameters</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/the-standard-query-parser.html">The Standard Query Parser</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/the-dismax-query-parser.html">The DisMax Query Parser</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/the-extended-dismax-query-parser.html">The Extended DisMax Query Parser</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/function-queries.html">Function Queries</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/local-parameters-in-queries.html">Local Parameters in Queries</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/other-parsers.html">Other Parsers</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/faceting.html">Faceting</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/blockjoin-faceting.html">BlockJoin Faceting</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/highlighting.html">Highlighting</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/spell-checking.html">Spell Checking</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/query-re-ranking.html">Query Re-Ranking</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/learning-to-rank.html">Learning To Rank</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/transforming-result-documents.html">Transforming Result Documents</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/suggester.html">Suggester</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/morelikethis.html">MoreLikeThis</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/pagination-of-results.html">Pagination of Results</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/collapse-and-expand-results.html">Collapse and Expand Results</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/result-grouping.html">Result Grouping</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/result-clustering.html">Result Clustering</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/spatial-search.html">Spatial Search</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/the-terms-component.html">The Terms Component</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/the-term-vector-component.html">The Term Vector Component</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/the-stats-component.html">The Stats Component</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/the-query-elevation-component.html">The Query Elevation Component</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/response-writers.html">Response Writers</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/velocity-response-writer.html">Velocity Response Writer</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/near-real-time-searching.html">Near Real Time Searching</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/realtime-get.html">RealTime Get</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/exporting-result-sets.html">Exporting Result Sets</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/streaming-expressions.html">Streaming Expressions</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/stream-sources.html">Stream Source Reference</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/stream-decorators.html">Stream Decorator Reference</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/stream-evaluators.html">Stream Evaluator Reference</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/graph-traversal.html">Graph Traversal</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/parallel-sql-interface.html">Parallel SQL Interface</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/solr-jdbc-dbvisualizer.html">Solr JDBC - DbVisualizer</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/solr-jdbc-squirrel-sql.html">Solr JDBC - SQuirreL SQL</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/solr-jdbc-apache-zeppelin.html">Solr JDBC - Apache Zeppelin</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/solr-jdbc-python-jython.html">Solr JDBC - Python/Jython</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/solr-jdbc-r.html">Solr JDBC - R</a>
            
          </li>
          
        </ul>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/the-well-configured-solr-instance.html">The Well-Configured Solr Instance</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/configuring-solrconfig-xml.html">Configuring solrconfig.xml</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/datadir-and-directoryfactory-in-solrconfig.html">DataDir and DirectoryFactory in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/lib-directives-in-solrconfig.html">Lib Directives in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/schema-factory-definition-in-solrconfig.html">Schema Factory Definition in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/indexconfig-in-solrconfig.html">IndexConfig in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/requesthandlers-and-searchcomponents-in-solrconfig.html">RequestHandlers and SearchComponents in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/initparams-in-solrconfig.html">InitParams in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/updatehandlers-in-solrconfig.html">UpdateHandlers in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/query-settings-in-solrconfig.html">Query Settings in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/requestdispatcher-in-solrconfig.html">RequestDispatcher in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/update-request-processors.html">Update Request Processors</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/codec-factory.html">Codec Factory</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/solr-cores-and-solr-xml.html">Solr Cores and solr.xml</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/format-of-solr-xml.html">Format of solr.xml</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/defining-core-properties.html">Defining core.properties</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/coreadmin-api.html">CoreAdmin API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/config-sets.html">Config Sets</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/configuration-apis.html">Configuration APIs</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/blob-store-api.html">Blob Store API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/config-api.html">Config API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/request-parameters-api.html">Request Parameters API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/managed-resources.html">Managed Resources</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/implicit-requesthandlers.html">Implicit RequestHandlers</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/solr-plugins.html">Solr Plugins</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/adding-custom-plugins-in-solrcloud-mode.html">Adding Custom Plugins in SolrCloud Mode</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/jvm-settings.html">JVM Settings</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/managing-solr.html">Managing Solr</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/taking-solr-to-production.html">Taking Solr to Production</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/securing-solr.html">Securing Solr</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/authentication-and-authorization-plugins.html">Authentication and Authorization Plugins</a>
            
            <ul>
              
              <li class="sb-level4">
                <a href="https://solr.apache.org/guide/6_6/basic-authentication-plugin.html">Basic Authentication Plugin</a>
                
              </li>
              
              <li class="sb-level4">
                <a href="https://solr.apache.org/guide/6_6/hadoop-authentication-plugin.html">Hadoop Authentication Plugin</a>
                
              </li>
              
              <li class="sb-level4">
                <a href="https://solr.apache.org/guide/6_6/kerberos-authentication-plugin.html">Kerberos Authentication Plugin</a>
                
              </li>
              
              <li class="sb-level4">
                <a href="https://solr.apache.org/guide/6_6/rule-based-authorization-plugin.html">Rule-Based Authorization Plugin</a>
                
              </li>
              
            </ul>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/enabling-ssl.html">Enabling SSL</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/running-solr-on-hdfs.html">Running Solr on HDFS</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/making-and-restoring-backups.html">Making and Restoring Backups</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/configuring-logging.html">Configuring Logging</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/using-jmx-with-solr.html">Using JMX with Solr</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/mbean-request-handler.html">MBean Request Handler</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/performance-statistics-reference.html">Performance Statistics Reference</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/metrics-reporting.html">Metrics Reporting</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/v2-api.html">v2 API</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/solrcloud.html">SolrCloud</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/getting-started-with-solrcloud.html">Getting Started with SolrCloud</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/how-solrcloud-works.html">How SolrCloud Works</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/shards-and-indexing-data-in-solrcloud.html">Shards and Indexing Data in SolrCloud</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/distributed-requests.html">Distributed Requests</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/read-and-write-side-fault-tolerance.html">Read and Write Side Fault Tolerance</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/solrcloud-configuration-and-parameters.html">SolrCloud Configuration and Parameters</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/setting-up-an-external-zookeeper-ensemble.html">Setting Up an External ZooKeeper Ensemble</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/using-zookeeper-to-manage-configuration-files.html">Using ZooKeeper to Manage Configuration Files</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/zookeeper-access-control.html">ZooKeeper Access Control</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/collections-api.html">Collections API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/parameter-reference.html">Parameter Reference</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/command-line-utilities.html">Command Line Utilities</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/solrcloud-with-legacy-configuration-files.html">SolrCloud with Legacy Configuration Files</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="https://solr.apache.org/guide/6_6/configsets-api.html">ConfigSets API</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/rule-based-replica-placement.html">Rule-based Replica Placement</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/cross-data-center-replication-cdcr.html">Cross Data Center Replication (CDCR)</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/legacy-scaling-and-distribution.html">Legacy Scaling and Distribution</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/introduction-to-scaling-and-distribution.html">Introduction to Scaling and Distribution</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/distributed-search-with-index-sharding.html">Distributed Search with Index Sharding</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/index-replication.html">Index Replication</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/combining-distribution-and-replication.html">Combining Distribution and Replication</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/merging-indexes.html">Merging Indexes</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/client-apis.html">Client APIs</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/introduction-to-client-apis.html">Introduction to Client APIs</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/choosing-an-output-format.html">Choosing an Output Format</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/client-api-lineup.html">Client API Lineup</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/using-javascript.html">Using JavaScript</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/using-python.html">Using Python</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/using-solrj.html">Using SolrJ</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/using-solr-from-ruby.html">Using Solr From Ruby</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/major-changes-from-solr-5-to-solr-6.html">Major Changes from Solr 5 to Solr 6</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/upgrading-a-solr-cluster.html">Upgrading a Solr Cluster</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="https://solr.apache.org/guide/6_6/indexupgrader-tool.html">IndexUpgrader Tool</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/further-assistance.html">Further Assistance</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/solr-glossary.html">Solr Glossary</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="https://solr.apache.org/guide/6_6/errata.html">Errata</a>
    
  </li>
  
</ul>


<!-- set the 'active' class on the current page and ancestors -->
<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("#mysidebar a[href='uploading-structured-data-store-data-with-the-data-import-handler.html']").parents('li').toggleClass("active", true);</script>
<!-- set the 'current' class on the current page and 'current-tree' on the current page + it's ancestors -->
<!-- this can let us do css highlighting of the current page in the sidebar even if/when the user clicks around in the sidebar causing other sidebar elements to be 'active' -->
<script>
  $("#mysidebar a[href='uploading-structured-data-store-data-with-the-data-import-handler.html']").parent('li').toggleClass("current", true);
  $("#mysidebar a[href='uploading-structured-data-store-data-with-the-data-import-handler.html']").parents('li').toggleClass("current-tree", true);
</script>

    </div>
    <!-- Content Column -->
    <div class="col-md-9">
      <div class="post-header">
   <h1 class="post-title-main">Uploading Structured Data Store Data with the Data Import Handler</h1>
</div>

<!-- This adds a workflow map, to a page
     See http://idratherbewriting.com/documentation-theme-jekyll/mydoc_workflow_maps.html
     Leaving it here commented out in case we want to implement this in the future
 -->

<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->

<script src="https://solr.apache.org/guide/6_6/js/ref-guide-toc.js" type="text/javascript"></script>
<script type="text/javascript">
  // based on page variables, build up the list of headers for the top level toc (and any sub-section tocs)
  do_tocs(1)
</script>
<div id="toc" class="toc toc-normal"></div>

    

<div class="main-content">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Many search applications store the content to be indexed in a structured data store, such as a relational database. The Data Import Handler (DIH) provides a mechanism for importing content from a data store and indexing it.</p>
</div>
<div class="paragraph">
<p>In addition to relational databases, DIH can index content from HTTP based data sources such as RSS and ATOM feeds, e-mail repositories, and structured XML where an XPath processor is used to generate fields.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dih-concepts-and-terminology">DIH Concepts and Terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Descriptions of the Data Import Handler use several familiar terms, such as entity and processor, in specific ways, as explained in the table below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Datasource</dt>
<dd>
<p>As its name suggests, a datasource defines the location of the data of interest. For a database, it&#8217;s a DSN. For an HTTP datasource, it&#8217;s the base URL.</p>
</dd>
<dt class="hdlist1">Entity</dt>
<dd>
<p>Conceptually, an entity is processed to generate a set of documents, containing multiple fields, which (after optionally being transformed in various ways) are sent to Solr for indexing. For a RDBMS data source, an entity is a view or table, which would be processed by one or more SQL statements to generate a set of rows (documents) with one or more columns (fields).</p>
</dd>
<dt class="hdlist1">Processor</dt>
<dd>
<p>An entity processor does the work of extracting content from a data source, transforming it, and adding it to the index. Custom entity processors can be written to extend or replace the ones supplied.</p>
</dd>
<dt class="hdlist1">Transformer</dt>
<dd>
<p>Each set of fields fetched by the entity may optionally be transformed. This process can modify the fields, create new fields, or generate multiple rows/documents form a single row. There are several built-in transformers in the DIH, which perform functions such as modifying dates and stripping HTML. It is possible to write custom transformers using the publicly available interface.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solr-s-dih-examples">Solr&#8217;s DIH Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>example/example-DIH</code> directory contains several collections to demonstrate many of the features of the data import handler. These are available with the <code>dih</code> example from the <a href="https://solr.apache.org/guide/6_6/solr-control-script-reference.html#solr-control-script-reference">Solr Control Script</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">bin/solr -e dih</code></pre>
</div>
</div>
<div class="paragraph">
<p>This launches a standalone Solr instance with several collections that correspond to detailed examples. The available examples are <code>atom</code>, <code>db</code>, <code>mail</code>, <code>solr</code>, and <code>tika</code>.</p>
</div>
<div class="paragraph">
<p>All examples in this section assume you are running the DIH example server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-dih">Configuring DIH</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="configuring-solrconfig-xml-for-dih">Configuring solrconfig.xml for DIH</h3>
<div class="paragraph">
<p>The Data Import Handler has to be registered in <code>solrconfig.xml</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;requestHandler</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;/dataimport&quot;</span> <span style="color: #7D9029">class=</span><span style="color: #BA2121">&quot;org.apache.solr.handler.dataimport.DataImportHandler&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;lst</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;defaults&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;str</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;config&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>/path/to/my/DIHconfigfile.xml<span style="color: #008000; font-weight: bold">&lt;/str&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/lst&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/requestHandler&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The only required parameter is the <code>config</code> parameter, which specifies the location of the DIH configuration file that contains specifications for the data source, how to fetch data, what data to fetch, and how to process it to generate the Solr documents to be posted to the index.</p>
</div>
<div class="paragraph">
<p>You can have multiple DIH configuration files. Each file would require a separate definition in the <code>solrconfig.xml</code> file, specifying a path to the file.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuring-the-dih-configuration-file">Configuring the DIH Configuration File</h3>
<div class="paragraph">
<p>An annotated configuration file, based on the <code>db</code> collection in the <code>dih</code> example server, is shown below (this file is located in <code>example/example-DIH/solr/db/conf/db-data-config.xml</code>).</p>
</div>
<div class="paragraph">
<p>This example shows how to extract fields from four tables defining a simple product database. More information about the parameters and options shown here will be described in the sections following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataConfig&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>

  <span style="color: #008000; font-weight: bold">&lt;dataSource</span> <span style="color: #7D9029">driver=</span><span style="color: #BA2121">&quot;org.hsqldb.jdbcDriver&quot;</span> <span style="color: #7D9029">url=</span><span style="color: #BA2121">&quot;jdbc:hsqldb:./example-DIH/hsqldb/ex&quot;</span> <span style="color: #7D9029">user=</span><span style="color: #BA2121">&quot;sa&quot;</span> <span style="color: #7D9029">password=</span><span style="color: #BA2121">&quot;secret&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span style="color: #008000; font-weight: bold">&lt;document&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;item&quot;</span> <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select * from item&quot;</span>
            <span style="color: #7D9029">deltaQuery=</span><span style="color: #BA2121">&quot;select id from item where last_modified &gt; &#39;${dataimporter.last_index_time}&#39;&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span> <i class="conum" data-value="4"></i><b>(4)</b>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;NAME&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>

      <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;feature&quot;</span>
              <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select DESCRIPTION from FEATURE where ITEM_ID=&#39;${item.ID}&#39;&quot;</span>
              <span style="color: #7D9029">deltaQuery=</span><span style="color: #BA2121">&quot;select ITEM_ID from FEATURE where last_modified &gt; &#39;${dataimporter.last_index_time}&#39;&quot;</span>
              <span style="color: #7D9029">parentDeltaQuery=</span><span style="color: #BA2121">&quot;select ID from item where ID=${feature.ITEM_ID}&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span> <i class="conum" data-value="5"></i><b>(5)</b>
        <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;features&quot;</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;DESCRIPTION&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>

      <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;item_category&quot;</span>
              <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select CATEGORY_ID from item_category where ITEM_ID=&#39;${item.ID}&#39;&quot;</span>
              <span style="color: #7D9029">deltaQuery=</span><span style="color: #BA2121">&quot;select ITEM_ID, CATEGORY_ID from item_category where last_modified &gt; &#39;${dataimporter.last_index_time}&#39;&quot;</span>
              <span style="color: #7D9029">parentDeltaQuery=</span><span style="color: #BA2121">&quot;select ID from item where ID=${item_category.ITEM_ID}&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;category&quot;</span>
                <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select DESCRIPTION from category where ID = &#39;${item_category.CATEGORY_ID}&#39;&quot;</span>
                <span style="color: #7D9029">deltaQuery=</span><span style="color: #BA2121">&quot;select ID from category where last_modified &gt; &#39;${dataimporter.last_index_time}&#39;&quot;</span>
                <span style="color: #7D9029">parentDeltaQuery=</span><span style="color: #BA2121">&quot;select ITEM_ID, CATEGORY_ID from item_category where CATEGORY_ID=${category.ID}&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
          <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;description&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;cat&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/document&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dataConfig&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first element is the <code>dataSource</code>, in this case an HSQLDB database. The path to the JDBC driver and the JDBC URL and login credentials are all specified here. Other permissible attributes include whether or not to autocommit to Solr, the batchsize used in the JDBC connection, and a <code>readOnly</code> flag. The password attribute is optional if there is no password set for the DB.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Alternately the password can be encrypted as follows. This is the value obtained as a result of the command <code>openssl enc -aes-128-cbc -a -salt -in pwd.txt password="U2FsdGVkX18QMjY0yfCqlfBMvAB4d3XkwY96L7gfO2o="</code>. When the password is encrypted, you must provide an extra attribute <code>encryptKeyFile="/location/of/encryptionkey"</code>. This file should a text file with a single line containing the encrypt/decrypt password.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>A <code>document</code> element follows, containing multiple <code>entity</code> elements. Note that <code>entity</code> elements can be nested, and this allows the entity relationships in the sample database to be mirrored here, so that we can generate a denormalized Solr record which may include multiple features for one item, for instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The possible attributes for the <code>entity</code> element are described in later sections. Entity elements may contain one or more <code>field</code> elements, which map the data source field names to Solr fields, and optionally specify per-field transformations. This entity is the <code>root</code> entity.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>This entity is nested and reflects the one-to-many relationship between an item and its multiple features. Note the use of variables; <code>${item.ID}</code> is the value of the column 'ID' for the current item (<code>item</code> referring to the entity name).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Datasources can still be specified in <code>solrconfig.xml</code>. These must be specified in the defaults section of the handler in <code>solrconfig.xml</code>. However, these are not parsed until the main configuration is loaded.</p>
</div>
<div class="paragraph">
<p>The entire configuration itself can be passed as a request parameter using the <code>dataConfig</code> parameter rather than using a file. When configuration errors are encountered, the error message is returned in XML format.</p>
</div>
<div class="paragraph">
<p>A <code>reload-config</code> command is also supported, which is useful for validating a new configuration file, or if you want to specify a file, load it, and not have it reloaded again on import. If there is an <code>xml</code> mistake in the configuration a user-friendly message is returned in <code>xml</code> format. You can then fix the problem and do a <code>reload-config</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can also view the DIH configuration in the Solr Admin UI from the <a href="https://solr.apache.org/guide/6_6/dataimport-screen.html#dataimport-screen">Dataimport Screen</a>. It includes an interface to import content.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="dih-request-parameters">DIH Request Parameters</h4>
<div class="paragraph">
<p>Request parameters can be substituted in configuration with placeholder <code>${dataimporter.request.<em>paramname</em>}</code>, as in this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataSource</span> <span style="color: #7D9029">driver=</span><span style="color: #BA2121">&quot;org.hsqldb.jdbcDriver&quot;</span>
            <span style="color: #7D9029">url=</span><span style="color: #BA2121">&quot;${dataimporter.request.jdbcurl}&quot;</span>
	    <span style="color: #7D9029">user=</span><span style="color: #BA2121">&quot;${dataimporter.request.jdbcuser}&quot;</span>
	    <span style="color: #7D9029">password=</span><span style="color: #BA2121">&quot;${dataimporter.request.jdbcpassword}&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These parameters can then be passed to the <code>full-import</code> command or defined in the <code>&lt;defaults&gt;</code> section in <code>solrconfig.xml</code>. This example shows the parameters with the full-import command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">http://localhost:8983/solr/dih/dataimport?command<span style="color: #666666">=</span>full-import&amp;<span style="color: #19177C">jdbcurl</span><span style="color: #666666">=</span>jdbc:hsqldb:./example-DIH/hsqldb/ex&amp;<span style="color: #19177C">jdbcuser</span><span style="color: #666666">=</span>sa&amp;<span style="color: #19177C">jdbcpassword</span><span style="color: #666666">=</span>secret</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dataimporthandler-commands">DataImportHandler Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DIH commands are sent to Solr via an HTTP request. The following operations are supported.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">abort</dt>
<dd>
<p>Aborts an ongoing operation. For example: <code>http://localhost:8983/solr/dih/dataimport?command=abort</code>.</p>
</dd>
<dt class="hdlist1">delta-import</dt>
<dd>
<p>For incremental imports and change detection. Only the <a href="#the-sql-entity-processor">SqlEntityProcessor</a> supports delta imports.</p>
<div class="paragraph">
<p>For example: <code>http://localhost:8983/solr/dih/dataimport?command=delta-import</code>.</p>
</div>
<div class="paragraph">
<p>This command supports the same <code>clean</code>, <code>commit</code>, <code>optimize</code> and <code>debug</code> parameters as <code>full-import</code> command described below.</p>
</div>
</dd>
<dt class="hdlist1">full-import</dt>
<dd>
<p>A Full Import operation can be started with a URL such as <code>http://localhost:8983/solr/dih/dataimport?command=full-import</code>. The command returns immediately.</p>
<div class="paragraph">
<p>The operation will be started in a new thread and the <em>status</em> attribute in the response should be shown as <em>busy</em>. The operation may take some time depending on the size of dataset. Queries to Solr are not blocked during full-imports.</p>
</div>
<div class="paragraph">
<p>When a <code>full-import</code> command is executed, it stores the start time of the operation in a file located at <code>conf/dataimport.properties</code>. This stored timestamp is used when a <code>delta-import</code> operation is executed.</p>
</div>
<div class="paragraph">
<p>Commands available to <code>full-import</code> are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">clean</dt>
<dd>
<p>Default is true. Tells whether to clean up the index before the indexing is started.</p>
</dd>
<dt class="hdlist1">commit</dt>
<dd>
<p>Default is true. Tells whether to commit after the operation.</p>
</dd>
<dt class="hdlist1">debug</dt>
<dd>
<p>Default is false. Runs the command in debug mode and is used by the interactive development mode.</p>
<div class="paragraph">
<p>Note that in debug mode, documents are never committed automatically. If you want to run debug mode and commit the results too, add <code>commit=true</code> as a request parameter.</p>
</div>
</dd>
<dt class="hdlist1">entity</dt>
<dd>
<p>The name of an entity directly under the <code>&lt;document&gt;</code> tag in the configuration file. Use this to execute one or more entities selectively.</p>
<div class="paragraph">
<p>Multiple "entity" parameters can be passed on to run multiple entities at once. If nothing is passed, all entities are executed.</p>
</div>
</dd>
<dt class="hdlist1">optimize</dt>
<dd>
<p>Default is true. Tells Solr whether to optimize after the operation.</p>
</dd>
<dt class="hdlist1">synchronous</dt>
<dd>
<p>Blocks request until import is completed. Default is false.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">reload-config</dt>
<dd>
<p>If the configuration file has been changed and you wish to reload it without restarting Solr, run the command <code>http://localhost:8983/solr/dih/dataimport?command=reload-config</code></p>
</dd>
<dt class="hdlist1">status</dt>
<dd>
<p>This command returns statistics on the number of documents created, deleted, queries run, rows fetched, status, and so on. For example:  <code>http://localhost:8983/solr/dih/dataimport?command=status</code>.</p>
</dd>
<dt class="hdlist1">show-config</dt>
<dd>
<p>This command responds with configuration: <code>http://localhost:8983/solr/dih/dataimport?command=show-config</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="property-writer">Property Writer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>propertyWriter</code> element defines the date format and locale for use with delta queries. It is an optional configuration. Add the element to the DIH configuration file, directly under the <code>dataConfig</code> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;propertyWriter</span> <span style="color: #7D9029">dateFormat=</span><span style="color: #BA2121">&quot;yyyy-MM-dd HH:mm:ss&quot;</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;SimplePropertiesWriter&quot;</span>
                <span style="color: #7D9029">directory=</span><span style="color: #BA2121">&quot;data&quot;</span> <span style="color: #7D9029">filename=</span><span style="color: #BA2121">&quot;my_dih.properties&quot;</span> <span style="color: #7D9029">locale=</span><span style="color: #BA2121">&quot;en-US&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameters available are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">dateFormat</dt>
<dd>
<p>A <code>java.text.SimpleDateFormat</code> to use when converting the date to text. The default is <code>yyyy-MM-dd HH:mm:ss</code>.</p>
</dd>
<dt class="hdlist1">type</dt>
<dd>
<p>The implementation class. Use <code>SimplePropertiesWriter</code> for non-SolrCloud installations. If using SolrCloud, use <code>ZKPropertiesWriter</code>.</p>
<div class="paragraph">
<p>If this is not specified, it will default to the appropriate class depending on if SolrCloud mode is enabled.</p>
</div>
</dd>
<dt class="hdlist1">directory</dt>
<dd>
<p>Used with the <code>SimplePropertiesWriter</code> only. The directory for the properties file. If not specified, the default is <code>conf</code>.</p>
</dd>
<dt class="hdlist1">filename</dt>
<dd>
<p>Used with the <code>SimplePropertiesWriter</code> only. The name of the properties file.</p>
<div class="paragraph">
<p>If not specified, the default is the requestHandler name (as defined in <code>solrconfig.xml</code>, appended by ".properties" (such as, <code>dataimport.properties</code>).</p>
</div>
</dd>
<dt class="hdlist1">locale</dt>
<dd>
<p>The locale. If not defined, the ROOT locale is used. It must be specified as language-country (<a href="https://tools.ietf.org/html/bcp47">BCP 47 language tag</a>). For example, <code>en-US</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-sources">Data Sources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A data source specifies the origin of data and its type. Somewhat confusingly, some data sources are configured within the associated entity processor. Data sources can also be specified in <code>solrconfig.xml</code>, which is useful when you have multiple environments (for example, development, QA, and production) differing only in their data sources.</p>
</div>
<div class="paragraph">
<p>You can create a custom data source by writing a class that extends <code>org.apache.solr.handler.dataimport.DataSource</code>.</p>
</div>
<div class="paragraph">
<p>The mandatory attributes for a data source definition are its name and type. The name identifies the data source to an Entity element.</p>
</div>
<div class="paragraph">
<p>The types of data sources available are described below.</p>
</div>
<div class="sect2">
<h3 id="contentstreamdatasource">ContentStreamDataSource</h3>
<div class="paragraph">
<p>This takes the POST data as the data source. This can be used with any EntityProcessor that uses a <code>DataSource&lt;Reader&gt;</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="fieldreaderdatasource">FieldReaderDataSource</h3>
<div class="paragraph">
<p>This can be used where a database field contains XML which you wish to process using the XPathEntityProcessor. You would set up a configuration with both JDBC and FieldReader data sources, and two entities, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataSource</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;a1&quot;</span> <span style="color: #7D9029">driver=</span><span style="color: #BA2121">&quot;org.hsqldb.jdbcDriver&quot;</span> <span style="border: 1px solid #FF0000">...</span>  <span style="color: #008000; font-weight: bold">/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;dataSource</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;a2&quot;</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;FieldReaderDataSource&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;document&gt;</span>

  <span style="color: #408080; font-style: italic">&lt;!-- processor for database --&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name =</span><span style="color: #BA2121">&quot;e1&quot;</span> <span style="color: #7D9029">dataSource=</span><span style="color: #BA2121">&quot;a1&quot;</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;SqlEntityProcessor&quot;</span> <span style="color: #7D9029">pk=</span><span style="color: #BA2121">&quot;docid&quot;</span>
          <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select * from t1 ...&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>

    <span style="color: #408080; font-style: italic">&lt;!-- nested XpathEntity; the field in the parent which is to be used for</span>
<span style="color: #408080; font-style: italic">         XPath is set in the &quot;datafield&quot; attribute in place of the &quot;url&quot; attribute --&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;e2&quot;</span> <span style="color: #7D9029">dataSource=</span><span style="color: #BA2121">&quot;a2&quot;</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;XPathEntityProcessor&quot;</span>
            <span style="color: #7D9029">dataField=</span><span style="color: #BA2121">&quot;e1.fieldToUseForXPath&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>

      <span style="color: #408080; font-style: italic">&lt;!-- XPath configuration follows --&gt;</span>
      ...
    <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/document&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>FieldReaderDataSource</code> can take an <code>encoding</code> parameter, which will default to "UTF-8" if not specified. It must be specified as language-country. For example, <code>en-US</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="filedatasource">FileDataSource</h3>
<div class="paragraph">
<p>This can be used like a <a href="#urldatasource">URLDataSource</a>, but is used to fetch content from files on disk. The only difference from <code>URLDataSource</code>, when accessing disk files, is how a pathname is specified.</p>
</div>
<div class="paragraph">
<p>This data source accepts these optional attributes.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">basePath</dt>
<dd>
<p>The base path relative to which the value is evaluated if it is not absolute.</p>
</dd>
<dt class="hdlist1">encoding</dt>
<dd>
<p>Defines the character encoding to use. If not defined, UTF-8 is used.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="jdbcdatasource">JdbcDataSource</h3>
<div class="paragraph">
<p>This is the default datasource. It&#8217;s used with the <a href="#the-sql-entity-processor">SqlEntityProcessor</a>. See the example in the <a href="#fieldreaderdatasource">FieldReaderDataSource</a> section for details on configuration. <code>JdbcDatasource</code> supports at least the following attributes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">driver, url, user, password, encryptKeyFile</dt>
<dd>
<p>Usual JDBC connection properties.</p>
</dd>
<dt class="hdlist1">batchSize</dt>
<dd>
<p>Passed to <code>Statement#setFetchSize</code>, default value 500.</p>
<div class="paragraph">
<p>For MySQL driver, which doesn&#8217;t honor fetchSize and pulls whole resultSet, which often lead to OutOfMemoryError.</p>
</div>
<div class="paragraph">
<p>In this case, set <code>batchSize=-1</code> that pass setFetchSize(Integer.MIN_VALUE), and switch result set to pull row by row</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>All of them substitute properties via <code>${placeholders}</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="urldatasource">URLDataSource</h3>
<div class="paragraph">
<p>This data source is often used with <a href="#the-xpathentityprocessor">XPathEntityProcessor</a> to fetch content from an underlying <code>file://</code> or <code>http://</code> location. Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataSource</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;a&quot;</span>
            <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;URLDataSource&quot;</span>
            <span style="color: #7D9029">baseUrl=</span><span style="color: #BA2121">&quot;http://host:port/&quot;</span>
            <span style="color: #7D9029">encoding=</span><span style="color: #BA2121">&quot;UTF-8&quot;</span>
            <span style="color: #7D9029">connectionTimeout=</span><span style="color: #BA2121">&quot;5000&quot;</span>
            <span style="color: #7D9029">readTimeout=</span><span style="color: #BA2121">&quot;10000&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The URLDataSource type accepts these optional parameters:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">baseURL</dt>
<dd>
<p>Specifies a new baseURL for pathnames. You can use this to specify host/port changes between Dev/QA/Prod environments. Using this attribute isolates the changes to be made to the <code>solrconfig.xml</code></p>
</dd>
<dt class="hdlist1">connectionTimeout</dt>
<dd>
<p>Specifies the length of time in milliseconds after which the connection should time out. The default value is 5000ms.</p>
</dd>
<dt class="hdlist1">encoding</dt>
<dd>
<p>By default the encoding in the response header is used. You can use this property to override the default encoding.</p>
</dd>
<dt class="hdlist1">readTimeout</dt>
<dd>
<p>Specifies the length of time in milliseconds after which a read operation should time out. The default value is 10000ms.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entity-processors">Entity Processors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Entity processors extract data, transform it, and add it to a Solr index. Examples of entities include views or tables in a data store.</p>
</div>
<div class="paragraph">
<p>Each processor has its own set of attributes, described in its own section below. In addition, there are several attributes common to all entities which may be specified:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">dataSource</dt>
<dd>
<p>The name of a data source. If there are multiple data sources defined, use this attribute with the name of the data source for this entity.</p>
</dd>
<dt class="hdlist1">name</dt>
<dd>
<p>Required. The unique name used to identify an entity.</p>
</dd>
<dt class="hdlist1">pk</dt>
<dd>
<p>The primary key for the entity. It is optional, and required only when using delta-imports. It has no relation to the uniqueKey defined in <code>schema.xml</code> but they can both be the same.</p>
<div class="paragraph">
<p>This attribute is mandatory if you do delta-imports and then refer to the column name in <code>${dataimporter.delta.&lt;column-name&gt;}</code> which is used as the primary key.</p>
</div>
</dd>
<dt class="hdlist1">processor</dt>
<dd>
<p>Default is <a href="#the-sql-entity-processor">SqlEntityProcessor</a>. Required only if the datasource is not RDBMS.</p>
</dd>
<dt class="hdlist1">onError</dt>
<dd>
<p>Defines what to do if an error is encountered.</p>
<div class="paragraph">
<p>Permissible values are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">abort</dt>
<dd>
<p>Stops the import.</p>
</dd>
<dt class="hdlist1">skip</dt>
<dd>
<p>Skips the current document.</p>
</dd>
<dt class="hdlist1">continue</dt>
<dd>
<p>Ignores the error and processing continues.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">preImportDeleteQuery</dt>
<dd>
<p>Before a <code>full-import</code> command, use this query this to cleanup the index instead of using <code>*:*</code>. This is honored only on an entity that is an immediate sub-child of <code>&lt;document&gt;</code>.</p>
</dd>
<dt class="hdlist1">postImportDeleteQuery</dt>
<dd>
<p>Similar to <code>preImportDeleteQuery</code>, but it executes after the import has completed.</p>
</dd>
<dt class="hdlist1">rootEntity</dt>
<dd>
<p>By default the entities immediately under <code>&lt;document&gt;</code> are root entities. If this attribute is set to false, the entity directly falling under that entity will be treated as the root entity (and so on). For every row returned by the root entity, a document is created in Solr.</p>
</dd>
<dt class="hdlist1">transformer</dt>
<dd>
<p>Optional. One or more transformers to be applied on this entity.</p>
</dd>
<dt class="hdlist1">cacheImpl</dt>
<dd>
<p>Optional. A class (which must implement <code>DIHCache</code>) to use for caching this entity when doing lookups from an entity which wraps it. Provided implementation is <code>SortedMapBackedCache</code>.</p>
</dd>
<dt class="hdlist1">cacheKey</dt>
<dd>
<p>The name of a property of this entity to use as a cache key if <code>cacheImpl</code> is specified.</p>
</dd>
<dt class="hdlist1">cacheLookup</dt>
<dd>
<p>An entity + property name that will be used to lookup cached instances of this entity if <code>cacheImpl</code> is specified.</p>
</dd>
<dt class="hdlist1">where</dt>
<dd>
<p>An alternative way to specify <code>cacheKey</code> and <code>cacheLookup</code> concatenated with '='.</p>
<div class="paragraph">
<p>For example, <code>where="CODE=People.COUNTRY_CODE"</code> is equivalent to <code>cacheKey="CODE" cacheLookup="People.COUNTRY_CODE"</code></p>
</div>
</dd>
<dt class="hdlist1">child="true"</dt>
<dd>
<p>Enables indexing document blocks aka <a href="https://solr.apache.org/guide/6_6/uploading-data-with-index-handlers.html#uploading-data-with-index-handlers">Nested Child Documents</a> for searching with <a href="https://solr.apache.org/guide/6_6/other-parsers.html#other-parsers">Block Join Query Parsers</a>. It can be only specified on the <code>&lt;entity&gt;</code> element under another root entity. It switches from default behavior (merging field values) to nesting documents as children documents.</p>
<div class="paragraph">
<p>Note: parent <code>&lt;entity&gt;</code> should add a field which is used as a parent filter in query time.</p>
</div>
</dd>
<dt class="hdlist1">join="zipper"</dt>
<dd>
<p>Enables merge join, aka "zipper" algorithm, for joining parent and child entities without cache. It should be specified at child (nested) <code>&lt;entity&gt;</code>. It implies that parent and child queries return results ordered by keys, otherwise it throws an exception. Keys should be specified either with <code>where</code> attribute or with <code>cacheKey</code> and <code>cacheLookup</code>.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="entity-caching">Entity Caching</h3>
<div class="paragraph">
<p>Caching of entities in DIH is provided to avoid repeated lookups for same entities again and again. The default <code>SortedMapBackedCache</code> is a <code>HashMap</code> where a key is a field in the row and the value is a bunch of rows for that same key.</p>
</div>
<div class="paragraph">
<p>In the example below, each <code>manufacturer</code> entity is cached using the <code>id</code> property as a cache key. Cache lookups will be performed for each <code>product</code> entity based on the product&#8217;s <code>manu</code> property. When the cache has no data for a particular key, the query is run and the cache is populated</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;product&quot;</span> <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select description,sku, manu from product&quot;</span> <span style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;manufacturer&quot;</span> <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select id, name from manufacturer&quot;</span>
          <span style="color: #7D9029">cacheKey=</span><span style="color: #BA2121">&quot;id&quot;</span> <span style="color: #7D9029">cacheLookup=</span><span style="color: #BA2121">&quot;product.manu&quot;</span> <span style="color: #7D9029">cacheImpl=</span><span style="color: #BA2121">&quot;SortedMapBackedCache&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-sql-entity-processor">The SQL Entity Processor</h3>
<div class="paragraph">
<p>The SqlEntityProcessor is the default processor. The associated <a href="#jdbcdatasource">JdbcDataSource</a> should be a JDBC URL.</p>
</div>
<div class="paragraph">
<p>The entity attributes specific to this processor are shown in the table below. These are in addition to the attributes common to all entity processors described above.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">query</dt>
<dd>
<p>Required. The SQL query used to select rows.</p>
</dd>
<dt class="hdlist1">deltaQuery</dt>
<dd>
<p>SQL query used if the operation is delta-import. This query selects the primary keys of the rows which will be parts of the delta-update. The pks will be available to the deltaImportQuery through the variable <code>${dataimporter.delta.&lt;column-name&gt;}</code>.</p>
</dd>
<dt class="hdlist1">parentDeltaQuery</dt>
<dd>
<p>SQL query used if the operation is <code>delta-import</code>.</p>
</dd>
<dt class="hdlist1">deletedPkQuery</dt>
<dd>
<p>SQL query used if the operation is <code>delta-import</code>.</p>
</dd>
<dt class="hdlist1">deltaImportQuery</dt>
<dd>
<p>SQL query used if the operation is <code>delta-import</code>. If this is not present, DIH tries to construct the import query by (after identifying the delta) modifying the 'query' (this is error prone).</p>
<div class="paragraph">
<p>There is a namespace <code>${dataimporter.delta.&lt;column-name&gt;}</code> which can be used in this query. For example, <code>select * from tbl where id=${dataimporter.delta.id}</code>.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="the-xpathentityprocessor">The XPathEntityProcessor</h3>
<div class="paragraph">
<p>This processor is used when indexing XML formatted data. The data source is typically <a href="#urldatasource">URLDataSource</a> or <a href="#filedatasource">FileDataSource</a>. XPath can also be used with the <a href="#the-filelistentityprocessor">FileListEntityProcessor</a> described below, to generate a document from each file.</p>
</div>
<div class="paragraph">
<p>The entity attributes unique to this processor are shown below. These are in addition to the attributes common to all entity processors described above.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Processor</dt>
<dd>
<p>Required. Must be set to <code>XpathEntityProcessor</code>.</p>
</dd>
<dt class="hdlist1">url</dt>
<dd>
<p>Required. The HTTP URL or file location.</p>
</dd>
<dt class="hdlist1">stream</dt>
<dd>
<p>Optional: Set to true for a large file or download.</p>
</dd>
<dt class="hdlist1">forEach</dt>
<dd>
<p>Required unless you define <code>useSolrAddSchema</code>. The XPath expression which demarcates each record. This will be used to set up the processing loop.</p>
</dd>
<dt class="hdlist1">xsl</dt>
<dd>
<p>Optional: Its value (a URL or filesystem path) is the name of a resource used as a preprocessor for applying the XSL transformation.</p>
</dd>
<dt class="hdlist1">useSolrAddSchema</dt>
<dd>
<p>Set this to true if the content is in the form of the standard Solr update XML schema.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Each <code>&lt;field&gt;</code> element in the entity can have the following attributes as well as the default ones.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">xpath</dt>
<dd>
<p>Required. The XPath expression which will extract the content from the record for this field. Only a subset of XPath syntax is supported.</p>
</dd>
<dt class="hdlist1">commonField</dt>
<dd>
<p>Optional. If true, then when this field is encountered in a record it will be copied to future records when creating a Solr document.</p>
</dd>
<dt class="hdlist1">flatten</dt>
<dd>
<p>Optional. If set to true, then any children text nodes are collected to form the value of a field.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The default value is false, meaning that if there are any sub-elements of the node pointed to by the XPath expression, they will be quietly omitted.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Here is an example from the <code>atom</code> collection in the <code>dih</code> example (data-config file found at <code>example/example-DIH/solr/atom/conf/atom-data-config.xml</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataConfig&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;dataSource</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;URLDataSource&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;document&gt;</span>

    <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;stackoverflow&quot;</span>
            <span style="color: #7D9029">url=</span><span style="color: #BA2121">&quot;https://stackoverflow.com/feeds/tag/solr&quot;</span>
            <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;XPathEntityProcessor&quot;</span>
            <span style="color: #7D9029">forEach=</span><span style="color: #BA2121">&quot;/feed|/feed/entry&quot;</span>
            <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;HTMLStripTransformer,RegexTransformer&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>

      <span style="color: #408080; font-style: italic">&lt;!-- Pick this value up from the feed level and apply to all documents --&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;lastchecked_dt&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/updated&quot;</span> <span style="color: #7D9029">commonField=</span><span style="color: #BA2121">&quot;true&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

      <span style="color: #408080; font-style: italic">&lt;!-- Keep only the final numeric part of the URL --&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;id&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/id&quot;</span> <span style="color: #7D9029">regex=</span><span style="color: #BA2121">&quot;.*/&quot;</span> <span style="color: #7D9029">replaceWith=</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;title&quot;</span>    <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/title&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;author&quot;</span>   <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/author/name&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;category&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/category/@term&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;link&quot;</span>     <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/link[@rel=&#39;alternate&#39;]/@href&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

      <span style="color: #408080; font-style: italic">&lt;!-- Use transformers to convert HTML into plain text.</span>
<span style="color: #408080; font-style: italic">        There is also an UpdateRequestProcess to trim remaining spaces.</span>
<span style="color: #408080; font-style: italic">      --&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;summary&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/summary&quot;</span> <span style="color: #7D9029">stripHTML=</span><span style="color: #BA2121">&quot;true&quot;</span> <span style="color: #7D9029">regex=</span><span style="color: #BA2121">&quot;( |\n)+&quot;</span> <span style="color: #7D9029">replaceWith=</span><span style="color: #BA2121">&quot; &quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

      <span style="color: #408080; font-style: italic">&lt;!-- Ignore namespaces when matching XPath --&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;rank&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/rank&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;published_dt&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/published&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;updated_dt&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/feed/entry/updated&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;/document&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dataConfig&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-mailentityprocessor">The MailEntityProcessor</h3>
<div class="paragraph">
<p>The MailEntityProcessor uses the Java Mail API to index email messages using the IMAP protocol.</p>
</div>
<div class="paragraph">
<p>The MailEntityProcessor works by connecting to a specified mailbox using a username and password, fetching the email headers for each message, and then fetching the full email contents to construct a document (one document for each mail message).</p>
</div>
<div class="paragraph">
<p>The entity attributes unique to the MailEntityProcessor are shown below. These are in addition to the attributes common to all entity processors described above.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">processor</dt>
<dd>
<p>Required. Must be set to <code>MailEntityProcessor</code>.</p>
</dd>
<dt class="hdlist1">user</dt>
<dd>
<p>Required. Username for authenticating to the IMAP server; this is typically the email address of the mailbox owner.</p>
</dd>
<dt class="hdlist1">password</dt>
<dd>
<p>Required. Password for authenticating to the IMAP server.</p>
</dd>
<dt class="hdlist1">host</dt>
<dd>
<p>Required. The IMAP server to connect to.</p>
</dd>
<dt class="hdlist1">protocol</dt>
<dd>
<p>Required. The IMAP protocol to use, valid values are: imap, imaps, gimap, and gimaps.</p>
</dd>
<dt class="hdlist1">fetchMailsSince</dt>
<dd>
<p>Optional. Date/time used to set a filter to import messages that occur after the specified date; expected format is: <code>yyyy-MM-dd HH:mm:ss</code>.</p>
</dd>
<dt class="hdlist1">folders</dt>
<dd>
<p>Required. Comma-delimited list of folder names to pull messages from, such as "inbox".</p>
</dd>
<dt class="hdlist1">recurse</dt>
<dd>
<p>Optional. Default is true. Flag to indicate if the processor should recurse all child folders when looking for messages to import.</p>
</dd>
<dt class="hdlist1">include</dt>
<dd>
<p>Optional. Comma-delimited list of folder patterns to include when processing folders (can be a literal value or regular expression).</p>
</dd>
<dt class="hdlist1">exclude</dt>
<dd>
<p>Optional. Comma-delimited list of folder patterns to exclude when processing folders (can be a literal value or regular expression). Excluded folder patterns take precedence over include folder patterns.</p>
</dd>
<dt class="hdlist1">processAttachement or processAttachments</dt>
<dd>
<p>Optional. Default is true. Use Tika to process message attachments.</p>
</dd>
<dt class="hdlist1">includeContent</dt>
<dd>
<p>Optional. Default is true. Include the message body when constructing Solr documents for indexing.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Here is an example from the <code>mail</code> collection of the <code>dih</code> example (data-config file found at <code>example/example-DIH/mail/conf/mail-data-config.xml</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataConfig&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;document&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;MailEntityProcessor&quot;</span>
              <span style="color: #7D9029">user=</span><span style="color: #BA2121">&quot;email@gmail.com&quot;</span>
              <span style="color: #7D9029">password=</span><span style="color: #BA2121">&quot;password&quot;</span>
              <span style="color: #7D9029">host=</span><span style="color: #BA2121">&quot;imap.gmail.com&quot;</span>
              <span style="color: #7D9029">protocol=</span><span style="color: #BA2121">&quot;imaps&quot;</span>
              <span style="color: #7D9029">fetchMailsSince=</span><span style="color: #BA2121">&quot;2014-06-30 00:00:00&quot;</span>
              <span style="color: #7D9029">batchSize=</span><span style="color: #BA2121">&quot;20&quot;</span>
              <span style="color: #7D9029">folders=</span><span style="color: #BA2121">&quot;inbox&quot;</span>
              <span style="color: #7D9029">processAttachement=</span><span style="color: #BA2121">&quot;false&quot;</span>
              <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;mail_entity&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/document&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dataConfig&gt;</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="importing-new-emails-only">Importing New Emails Only</h4>
<div class="paragraph">
<p>After running a full import, the MailEntityProcessor keeps track of the timestamp of the previous import so that subsequent imports can use the fetchMailsSince filter to only pull new messages from the mail server. This occurs automatically using the DataImportHandler <code>dataimport.properties</code> file (stored in <code>conf</code>).</p>
</div>
<div class="paragraph">
<p>For instance, if you set <code>fetchMailsSince="2014-08-22 00:00:00"</code> in your <code>mail-data-config.xml</code>, then all mail messages that occur after this date will be imported on the first run of the importer. Subsequent imports will use the date of the previous import as the <code>fetchMailsSince</code> filter, so that only new emails since the last import are indexed each time.</p>
</div>
</div>
<div class="sect3">
<h4 id="gmail-extensions">GMail Extensions</h4>
<div class="paragraph">
<p>When connecting to a GMail account, you can improve the efficiency of the MailEntityProcessor by setting the protocol to <strong>gimap</strong> or <strong>gimaps</strong>.</p>
</div>
<div class="paragraph">
<p>This allows the processor to send the <code>fetchMailsSince</code> filter to the GMail server to have the date filter applied on the server, which means the processor only receives new messages from the server. However, GMail only supports date granularity, so the server-side filter may return previously seen messages if run more than once a day.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-tikaentityprocessor">The TikaEntityProcessor</h3>
<div class="paragraph">
<p>The TikaEntityProcessor uses Apache Tika to process incoming documents. This is similar to <a href="https://solr.apache.org/guide/6_6/uploading-data-with-solr-cell-using-apache-tika.html#uploading-data-with-solr-cell-using-apache-tika">Uploading Data with Solr Cell using Apache Tika</a>, but using DataImportHandler options instead.</p>
</div>
<div class="paragraph">
<p>The parameters for this processor are described in the table below. These are in addition to the attributes common to all entity processors described above.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">dataSource</dt>
<dd>
<p>This parameter defines the data source and an optional name which can be referred to in later parts of the configuration if needed. This is the same <code>dataSource</code> explained in the description of general entity processor attributes above.</p>
<div class="paragraph">
<p>The available data source types for this processor are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>BinURLDataSource: used for HTTP resources, but can also be used for files.</p>
</li>
<li>
<p>BinContentStreamDataSource: used for uploading content as a stream.</p>
</li>
<li>
<p>BinFileDataSource: used for content on the local filesystem.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">url</dt>
<dd>
<p>Required. The path to the source file(s), as a file path or a traditional internet URL.</p>
</dd>
<dt class="hdlist1">htmlMapper</dt>
<dd>
<p>Optional. Allows control of how Tika parses HTML. If this parameter is defined, it must be either <strong>default</strong> or <strong>identity</strong>; if it is absent, "default" is assumed.</p>
<div class="paragraph">
<p>The "default" mapper strips much of the HTML from documents while the "identity" mapper passes all HTML as-is with no modifications.</p>
</div>
</dd>
<dt class="hdlist1">format</dt>
<dd>
<p>The output format. The options are <strong>text</strong>, <strong>xml</strong>, <strong>html</strong> or <strong>none</strong>. The default is "text" if not defined. The format "none" can be used if metadata only should be indexed and not the body of the documents.</p>
</dd>
<dt class="hdlist1">parser</dt>
<dd>
<p>Optional. The default parser is <code>org.apache.tika.parser.AutoDetectParser</code>. If a custom or other parser should be used, it should be entered as a fully-qualified name of the class and path.</p>
</dd>
<dt class="hdlist1">fields</dt>
<dd>
<p>The list of fields from the input documents and how they should be mapped to Solr fields. If the attribute <code>meta</code> is defined as "true", the field will be obtained from the metadata of the document and not parsed from the body of the main text.</p>
</dd>
<dt class="hdlist1">extractEmbedded</dt>
<dd>
<p>Instructs the TikaEntityProcessor to extract embedded documents or attachments when <strong>true</strong>. If false, embedded documents and attachments will be ignored.</p>
</dd>
<dt class="hdlist1">onError</dt>
<dd>
<p>By default, the TikaEntityProcessor will stop processing documents if it finds one that generates an error. If you define <code>onError</code> to "skip", the TikaEntityProcessor will instead skip documents that fail processing and log a message that the document was skipped.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Here is an example from the <code>tika</code> collection of the <code>dih</code> example (data-config file found in <code>example/example-DIH/tika/conf/tika-data-config.xml</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataConfig&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;dataSource</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;BinFileDataSource&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;document&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;file&quot;</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;FileListEntityProcessor&quot;</span> <span style="color: #7D9029">dataSource=</span><span style="color: #BA2121">&quot;null&quot;</span>
            <span style="color: #7D9029">baseDir=</span><span style="color: #BA2121">&quot;${solr.install.dir}/example/exampledocs&quot;</span> <span style="color: #7D9029">fileName=</span><span style="color: #BA2121">&quot;.*pdf&quot;</span>
            <span style="color: #7D9029">rootEntity=</span><span style="color: #BA2121">&quot;false&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>

      <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;file&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;id&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

      <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;pdf&quot;</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;TikaEntityProcessor&quot;</span>
              <span style="color: #7D9029">url=</span><span style="color: #BA2121">&quot;${file.fileAbsolutePath}&quot;</span> <span style="color: #7D9029">format=</span><span style="color: #BA2121">&quot;text&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>

        <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;Author&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;author&quot;</span> <span style="color: #7D9029">meta=</span><span style="color: #BA2121">&quot;true&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
        <span style="color: #408080; font-style: italic">&lt;!-- in the original PDF, the Author meta-field name is upper-cased,</span>
<span style="color: #408080; font-style: italic">          but in Solr schema it is lower-cased</span>
<span style="color: #408080; font-style: italic">         --&gt;</span>

        <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;title&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;title&quot;</span> <span style="color: #7D9029">meta=</span><span style="color: #BA2121">&quot;true&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;dc:format&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;format&quot;</span> <span style="color: #7D9029">meta=</span><span style="color: #BA2121">&quot;true&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

        <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;text&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;text&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

      <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/document&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dataConfig&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-filelistentityprocessor">The FileListEntityProcessor</h3>
<div class="paragraph">
<p>This processor is basically a wrapper, and is designed to generate a set of files satisfying conditions specified in the attributes which can then be passed to another processor, such as the <a href="#the-xpathentityprocessor">XPathEntityProcessor</a>.</p>
</div>
<div class="paragraph">
<p>The entity information for this processor would be nested within the FileListEntity entry. It generates five implicit fields: <code>fileAbsolutePath</code>, <code>fileDir</code>, <code>fileSize</code>, <code>fileLastModified</code>, and <code>file</code>, which can be used in the nested processor. This processor does not use a data source.</p>
</div>
<div class="paragraph">
<p>The attributes specific to this processor are described in the table below:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">fileName</dt>
<dd>
<p>Required. A regular expression pattern to identify files to be included.</p>
</dd>
<dt class="hdlist1">basedir</dt>
<dd>
<p>Required. The base directory (absolute path).</p>
</dd>
<dt class="hdlist1">recursive</dt>
<dd>
<p>Whether to search directories recursively. Default is 'false'.</p>
</dd>
<dt class="hdlist1">excludes</dt>
<dd>
<p>A regular expression pattern to identify files which will be excluded.</p>
</dd>
<dt class="hdlist1">newerThan</dt>
<dd>
<p>A date in the format <code>yyyy-MM-ddHH:mm:ss</code> or a date math expression (<code>NOW - 2YEARS</code>).</p>
</dd>
<dt class="hdlist1">olderThan</dt>
<dd>
<p>A date, using the same formats as newerThan.</p>
</dd>
<dt class="hdlist1">rootEntity</dt>
<dd>
<p>This should be set to false. This ensures that each row (filepath) emitted by this processor is considered to be a document.</p>
</dd>
<dt class="hdlist1">dataSource</dt>
<dd>
<p>Must be set to null.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The example below shows the combination of the FileListEntityProcessor with another processor which will generate a set of fields from each file found.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataConfig&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;dataSource</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;FileDataSource&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;document&gt;</span>
    <span style="color: #408080; font-style: italic">&lt;!-- this outer processor generates a list of files satisfying the conditions</span>
<span style="color: #408080; font-style: italic">         specified in the attributes --&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;f&quot;</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;FileListEntityProcessor&quot;</span>
            <span style="color: #7D9029">fileName=</span><span style="color: #BA2121">&quot;.*xml&quot;</span>
            <span style="color: #7D9029">newerThan=</span><span style="color: #BA2121">&quot;&#39;NOW-30DAYS&#39;&quot;</span>
            <span style="color: #7D9029">recursive=</span><span style="color: #BA2121">&quot;true&quot;</span>
            <span style="color: #7D9029">rootEntity=</span><span style="color: #BA2121">&quot;false&quot;</span>
            <span style="color: #7D9029">dataSource=</span><span style="color: #BA2121">&quot;null&quot;</span>
            <span style="color: #7D9029">baseDir=</span><span style="color: #BA2121">&quot;/my/document/directory&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>

      <span style="color: #408080; font-style: italic">&lt;!-- this processor extracts content using XPath from each file found --&gt;</span>

      <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;nested&quot;</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;XPathEntityProcessor&quot;</span>
              <span style="color: #7D9029">forEach=</span><span style="color: #BA2121">&quot;/rootelement&quot;</span> <span style="color: #7D9029">url=</span><span style="color: #BA2121">&quot;${f.fileAbsolutePath}&quot;</span> <span style="color: #008000; font-weight: bold">&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/rootelement/name&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;number&quot;</span> <span style="color: #7D9029">xpath=</span><span style="color: #BA2121">&quot;/rootelement/number&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/document&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dataConfig&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lineentityprocessor">LineEntityProcessor</h3>
<div class="paragraph">
<p>This EntityProcessor reads all content from the data source on a line by line basis and returns a field called <code>rawLine</code> for each line read. The content is not parsed in any way; however, you may add transformers to manipulate the data within the <code>rawLine</code> field, or to create other additional fields.</p>
</div>
<div class="paragraph">
<p>The lines read can be filtered by two regular expressions specified with the <code>acceptLineRegex</code> and <code>omitLineRegex</code> attributes.</p>
</div>
<div class="paragraph">
<p>The LineEntityProcessor has the following attributes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">url</dt>
<dd>
<p>A required attribute that specifies the location of the input file in a way that is compatible with the configured data source. If this value is relative and you are using FileDataSource or URLDataSource, it assumed to be relative to baseLoc.</p>
</dd>
<dt class="hdlist1">acceptLineRegex</dt>
<dd>
<p>An optional attribute that if present discards any line which does not match the regular expression.</p>
</dd>
<dt class="hdlist1">omitLineRegex</dt>
<dd>
<p>An optional attribute that is applied after any <code>acceptLineRegex</code> and that discards any line which matches this regular expression.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;jc&quot;</span>
        <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;LineEntityProcessor&quot;</span>
        <span style="color: #7D9029">acceptLineRegex=</span><span style="color: #BA2121">&quot;^.*\.xml$&quot;</span>
        <span style="color: #7D9029">omitLineRegex=</span><span style="color: #BA2121">&quot;/obsolete&quot;</span>
        <span style="color: #7D9029">url=</span><span style="color: #BA2121">&quot;file:///Volumes/ts/files.lis&quot;</span>
        <span style="color: #7D9029">rootEntity=</span><span style="color: #BA2121">&quot;false&quot;</span>
        <span style="color: #7D9029">dataSource=</span><span style="color: #BA2121">&quot;myURIreader1&quot;</span>
        <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;RegexTransformer,DateFormatTransformer&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>While there are use cases where you might need to create a Solr document for each line read from a file, it is expected that in most cases that the lines read by this processor will consist of a pathname, which in turn will be consumed by another entity processor, such as the XPathEntityProcessor.</p>
</div>
</div>
<div class="sect2">
<h3 id="plaintextentityprocessor">PlainTextEntityProcessor</h3>
<div class="paragraph">
<p>This EntityProcessor reads all content from the data source into an single implicit field called <code>plainText</code>. The content is not parsed in any way, however you may add <a href="#transformers">transformers</a> to manipulate the data within the <code>plainText</code> as needed, or to create other additional fields.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;PlainTextEntityProcessor&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;x&quot;</span> <span style="color: #7D9029">url=</span><span style="color: #BA2121">&quot;http://abc.com/a.txt&quot;</span> <span style="color: #7D9029">dataSource=</span><span style="color: #BA2121">&quot;data-source-name&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #408080; font-style: italic">&lt;!-- copies the text to a field called &#39;text&#39; in Solr--&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;plainText&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;text&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Ensure that the dataSource is of type <code>DataSource&lt;Reader&gt;</code> (<code>FileDataSource</code>, <code>URLDataSource</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="solrentityprocessor">SolrEntityProcessor</h3>
<div class="paragraph">
<p>This EntityProcessor imports data from different Solr instances and cores. The data is retrieved based on a specified filter query. This EntityProcessor is useful in cases you want to copy your Solr index and want to modify the data in the target index.</p>
</div>
<div class="paragraph">
<p>The SolrEntityProcessor can only copy fields that are stored in the source index.</p>
</div>
<div class="paragraph">
<p>The SolrEntityProcessor supports the following parameters:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">url</dt>
<dd>
<p>Required. The URL of the source Solr instance and/or core.</p>
</dd>
<dt class="hdlist1">query</dt>
<dd>
<p>Required. The main query to execute on the source index.</p>
</dd>
<dt class="hdlist1">fq</dt>
<dd>
<p>Any filter queries to execute on the source index. If more than one filter query is defined, they must be separated by a comma.</p>
</dd>
<dt class="hdlist1">rows</dt>
<dd>
<p>The number of rows to return for each iteration. The default is 50 rows.</p>
</dd>
<dt class="hdlist1">fl</dt>
<dd>
<p>A comma-separated list of fields to fetch from the source index. Note, these fields must be stored in the source Solr instance.</p>
</dd>
<dt class="hdlist1">qt</dt>
<dd>
<p>The search handler to use, if not the default.</p>
</dd>
<dt class="hdlist1">wt</dt>
<dd>
<p>The response format to use, either <strong>javabin</strong> or <strong>xml</strong>.</p>
</dd>
<dt class="hdlist1">timeout</dt>
<dd>
<p>The query timeout in seconds. The default is 5 minutes (300 seconds).</p>
</dd>
<dt class="hdlist1">cursorMark="true"</dt>
<dd>
<p>Use this to enable cursor for efficient result set scrolling</p>
</dd>
<dt class="hdlist1">sort="id asc"</dt>
<dd>
<p>This should be used to specify a sort parameter referencing the uniqueKey field of the source Solr instance. See <a href="https://solr.apache.org/guide/6_6/pagination-of-results.html#pagination-of-results">Pagination of Results</a> for details.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Here is a simple example of a SolrEntityProcessor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataConfig&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;document&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;sep&quot;</span> <span style="color: #7D9029">processor=</span><span style="color: #BA2121">&quot;SolrEntityProcessor&quot;</span>
            <span style="color: #7D9029">url=</span><span style="color: #BA2121">&quot;http://127.0.0.1:8983/solr/db &quot;</span>
            <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;*:*&quot;</span>
            <span style="color: #7D9029">fl=</span><span style="color: #BA2121">&quot;*,orig_version_l:_version_,ignored_price_c:price_c&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/document&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dataConfig&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="transformers">Transformers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Transformers manipulate the fields in a document returned by an entity. A transformer can create new fields or modify existing ones. You must tell the entity which transformers your import operation will be using, by adding an attribute containing a comma separated list to the <code>&lt;entity&gt;</code> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;abcde&quot;</span> <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;org.apache.solr....,my.own.transformer,...&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Specific transformation rules are then added to the attributes of a <code>&lt;field&gt;</code> element, as shown in the examples below. The transformers are applied in the order in which they are specified in the transformer attribute.</p>
</div>
<div class="paragraph">
<p>The DataImportHandler contains several built-in transformers. You can also write your own custom transformers, as described in the <a href="http://wiki.apache.org/solr/DIHCustomTransformer">DIHCustomTransformer</a> section of the Solr Wiki. The ScriptTransformer (described below) offers an alternative method for writing your own transformers.</p>
</div>
<div class="sect2">
<h3 id="clobtransformer">ClobTransformer</h3>
<div class="paragraph">
<p>You can use the ClobTransformer to create a string out of a CLOB in a database. A <a href="http://en.wikipedia.org/wiki/Character_large_object">CLOB</a> is a character large object: a collection of character data typically stored in a separate location that is referenced in the database.</p>
</div>
<div class="paragraph">
<p>The ClobTransformer accepts these attributes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">clob</dt>
<dd>
<p>Boolean value to signal if ClobTransformer should process this field or not. If this attribute is omitted, then the corresponding field is not transformed.</p>
</dd>
<dt class="hdlist1">sourceColName</dt>
<dd>
<p>The source column to be used as input. If this is absent source and target are same</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of invoking the ClobTransformer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;example&quot;</span> <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;ClobTransformer&quot;</span> <span style="border: 1px solid #FF0000">...</span><span style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;hugeTextField&quot;</span> <span style="color: #7D9029">clob=</span><span style="color: #BA2121">&quot;true&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
  ...
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-dateformattransformer">The DateFormatTransformer</h3>
<div class="paragraph">
<p>This transformer converts dates from one format to another. This would be useful, for example, in a situation where you wanted to convert a field with a fully specified date/time into a less precise date format, for use in faceting.</p>
</div>
<div class="paragraph">
<p>DateFormatTransformer applies only on the fields with an attribute <code>dateTimeFormat</code>. Other fields are not modified.</p>
</div>
<div class="paragraph">
<p>This transformer recognizes the following attributes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">dateTimeFormat</dt>
<dd>
<p>The format used for parsing this field. This must comply with the syntax of the <a href="http://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html">Java SimpleDateFormat</a> class.</p>
</dd>
<dt class="hdlist1">sourceColName</dt>
<dd>
<p>The column on which the dateFormat is to be applied. If this is absent source and target are same.</p>
</dd>
<dt class="hdlist1">locale</dt>
<dd>
<p>The locale to use for date transformations. If not defined, the ROOT locale is used. It must be specified as language-country (<a href="https://tools.ietf.org/html/bcp47">BCP 47 language tag</a>). For example, <code>en-US</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Here is example code that returns the date rounded up to the month "2007-JUL":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;en&quot;</span> <span style="color: #7D9029">pk=</span><span style="color: #BA2121">&quot;id&quot;</span> <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;DateFormatTransformer&quot;</span> <span style="border: 1px solid #FF0000">...</span> <span style="color: #008000; font-weight: bold">&gt;</span>
  ...
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;date&quot;</span> <span style="color: #7D9029">sourceColName=</span><span style="color: #BA2121">&quot;fulldate&quot;</span> <span style="color: #7D9029">dateTimeFormat=</span><span style="color: #BA2121">&quot;yyyy-MMM&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-htmlstriptransformer">The HTMLStripTransformer</h3>
<div class="paragraph">
<p>You can use this transformer to strip HTML out of a field.</p>
</div>
<div class="paragraph">
<p>There is one attribute for this transformer, <code>stripHTML</code>, which is a boolean value (true or false) to signal if the HTMLStripTransformer should process the field or not.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;e&quot;</span> <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;HTMLStripTransformer&quot;</span> <span style="border: 1px solid #FF0000">...</span> <span style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;htmlText&quot;</span> <span style="color: #7D9029">stripHTML=</span><span style="color: #BA2121">&quot;true&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
  ...
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-logtransformer">The LogTransformer</h3>
<div class="paragraph">
<p>You can use this transformer to log data to the console or log files. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="border: 1px solid #FF0000">...</span>
        <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;LogTransformer&quot;</span>
        <span style="color: #7D9029">logTemplate=</span><span style="color: #BA2121">&quot;The name is ${e.name}&quot;</span> <span style="color: #7D9029">logLevel=</span><span style="color: #BA2121">&quot;debug&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
  ....
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Unlike other transformers, the LogTransformer does not apply to any field, so the attributes are applied on the entity itself.</p>
</div>
</div>
<div class="sect2">
<h3 id="the-numberformattransformer">The NumberFormatTransformer</h3>
<div class="paragraph">
<p>Use this transformer to parse a number from a string, converting it into the specified format, and optionally using a different locale.</p>
</div>
<div class="paragraph">
<p>NumberFormatTransformer will be applied only to fields with an attribute <code>formatStyle</code>.</p>
</div>
<div class="paragraph">
<p>This transformer recognizes the following attributes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">formatStyle</dt>
<dd>
<p>The format used for parsing this field. The value of the attribute must be one of <code>number</code>, <code>percent</code>, <code>integer</code>, or <code>currency</code>. This uses the semantics of the Java NumberFormat class.</p>
</dd>
<dt class="hdlist1">sourceColName</dt>
<dd>
<p>The column on which the NumberFormat is to be applied. This is attribute is absent. The source column and the target column are the same.</p>
</dd>
<dt class="hdlist1">locale</dt>
<dd>
<p>The locale to be used for parsing the strings. The locale. If not defined, the ROOT locale is used. It must be specified as language-country (<a href="https://tools.ietf.org/html/bcp47">BCP 47 language tag</a>). For example, <code>en-US</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;en&quot;</span> <span style="color: #7D9029">pk=</span><span style="color: #BA2121">&quot;id&quot;</span> <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;NumberFormatTransformer&quot;</span> <span style="border: 1px solid #FF0000">...</span><span style="color: #008000; font-weight: bold">&gt;</span>
  ...

  <span style="color: #408080; font-style: italic">&lt;!-- treat this field as UK pounds --&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;price_uk&quot;</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;price&quot;</span> <span style="color: #7D9029">formatStyle=</span><span style="color: #BA2121">&quot;currency&quot;</span> <span style="color: #7D9029">locale=</span><span style="color: #BA2121">&quot;en-UK&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-regextransformer">The RegexTransformer</h3>
<div class="paragraph">
<p>The regex transformer helps in extracting or manipulating values from fields (from the source) using Regular Expressions. The actual class name is <code>org.apache.solr.handler.dataimport.RegexTransformer</code>. But as it belongs to the default package the package-name can be omitted.</p>
</div>
<div class="paragraph">
<p>The table below describes the attributes recognized by the regex transformer.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">regex</dt>
<dd>
<p>The regular expression that is used to match against the column or sourceColName&#8217;s value(s). If replaceWith is absent, each regex <em>group</em> is taken as a value and a list of values is returned.</p>
</dd>
<dt class="hdlist1">sourceColName</dt>
<dd>
<p>The column on which the regex is to be applied. If not present, then the source and target are identical.</p>
</dd>
<dt class="hdlist1">splitBy</dt>
<dd>
<p>Used to split a string. It returns a list of values. Note, this is a regular expression so it may need to be escaped (e.g., via back-slashes).</p>
</dd>
<dt class="hdlist1">groupNames</dt>
<dd>
<p>A comma separated list of field column names, used where the regex contains groups and each group is to be saved to a different field. If some groups are not to be named leave a space between commas.</p>
</dd>
<dt class="hdlist1">replaceWith</dt>
<dd>
<p>Used along with regex . It is equivalent to the method <code>new String(&lt;sourceColVal&gt;).replaceAll(&lt;regex&gt;, &lt;replaceWith&gt;)</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Here is an example of configuring the regex transformer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;foo&quot;</span> <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;RegexTransformer&quot;</span>
        <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select full_name, emailids from foo&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;full_name&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;firstName&quot;</span> <span style="color: #7D9029">regex=</span><span style="color: #BA2121">&quot;Mr(\w*)\b.*&quot;</span> <span style="color: #7D9029">sourceColName=</span><span style="color: #BA2121">&quot;full_name&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;lastName&quot;</span> <span style="color: #7D9029">regex=</span><span style="color: #BA2121">&quot;Mr.*?\b(\w*)&quot;</span> <span style="color: #7D9029">sourceColName=</span><span style="color: #BA2121">&quot;full_name&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>

  <span style="color: #408080; font-style: italic">&lt;!-- another way of doing the same --&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;fullName&quot;</span> <span style="color: #7D9029">regex=</span><span style="color: #BA2121">&quot;Mr(\w*)\b(.*)&quot;</span> <span style="color: #7D9029">groupNames=</span><span style="color: #BA2121">&quot;firstName,lastName&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;mailId&quot;</span> <span style="color: #7D9029">splitBy=</span><span style="color: #BA2121">&quot;,&quot;</span> <span style="color: #7D9029">sourceColName=</span><span style="color: #BA2121">&quot;emailids&quot;</span><span style="color: #008000; font-weight: bold">/&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In this example, <code>regex</code> and <code>sourceColName</code> are custom attributes used by the transformer.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The transformer reads the field <code>full_name</code> from the result set and transforms it to two new target fields, <code>firstName</code> and <code>lastName</code>. Even though the query returned only one column, <code>full_name</code>, in the result set, the Solr document gets two extra fields <code>firstName</code> and <code>lastName</code> which are "derived" fields. These new fields are only created if the regexp matches.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>emailids</code> field in the table can be a comma-separated value. It ends up producing one or more email IDs, and we expect the <code>mailId</code> to be a multivalued field in Solr.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that this transformer can be used to either split a string into tokens based on a splitBy pattern, or to perform a string substitution as per <code>replaceWith</code>, or it can assign groups within a pattern to a list of <code>groupNames</code>. It decides what it is to do based upon the above attributes <code>splitBy</code>, <code>replaceWith</code> and <code>groupNames</code> which are looked for in order. This first one found is acted upon and other unrelated attributes are ignored.</p>
</div>
</div>
<div class="sect2">
<h3 id="the-scripttransformer">The ScriptTransformer</h3>
<div class="paragraph">
<p>The script transformer allows arbitrary transformer functions to be written in any scripting language supported by Java, such as Javascript, JRuby, Jython, Groovy, or BeanShell. Javascript is integrated into Java 8; you&#8217;ll need to integrate other languages yourself.</p>
</div>
<div class="paragraph">
<p>Each function you write must accept a row variable (which corresponds to a <code>Java Map&lt;String,Object&gt;</code>, thus permitting <code>get,put,remove</code> operations). Thus you can modify the value of an existing field or add new fields. The return value of the function is the returned object.</p>
</div>
<div class="paragraph">
<p>The script is inserted into the DIH configuration file at the top level and is called once for each row.</p>
</div>
<div class="paragraph">
<p>Here is a simple example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;dataconfig&gt;</span>

  <span style="color: #408080; font-style: italic">&lt;!-- simple script to generate a new row, converting a temperature from Fahrenheit to Centigrade --&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;script&gt;</span><span style="color: #BC7A00">&lt;![CDATA[</span>
<span style="color: #BC7A00">    function f2c(row) {</span>
<span style="color: #BC7A00">      var tempf, tempc;</span>
<span style="color: #BC7A00">      tempf = row.get(&#39;temp_f&#39;);</span>
<span style="color: #BC7A00">      if (tempf != null) {</span>
<span style="color: #BC7A00">        tempc = (tempf - 32.0)*5.0/9.0;</span>
<span style="color: #BC7A00">        row.put(&#39;temp_c&#39;, temp_c);</span>
<span style="color: #BC7A00">      }</span>
<span style="color: #BC7A00">      return row;</span>
<span style="color: #BC7A00">    }</span>
<span style="color: #BC7A00">    ]]&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/script&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;document&gt;</span>

    <span style="color: #408080; font-style: italic">&lt;!-- the function is specified as an entity attribute --&gt;</span>

    <span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;e1&quot;</span> <span style="color: #7D9029">pk=</span><span style="color: #BA2121">&quot;id&quot;</span> <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;script:f2c&quot;</span> <span style="color: #7D9029">query=</span><span style="color: #BA2121">&quot;select * from X&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
      ....
    <span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/document&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dataConfig&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-templatetransformer">The TemplateTransformer</h3>
<div class="paragraph">
<p>You can use the template transformer to construct or modify a field value, perhaps using the value of other fields. You can insert extra text into the template.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;entity</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;en&quot;</span> <span style="color: #7D9029">pk=</span><span style="color: #BA2121">&quot;id&quot;</span> <span style="color: #7D9029">transformer=</span><span style="color: #BA2121">&quot;TemplateTransformer&quot;</span> <span style="border: 1px solid #FF0000">...</span><span style="color: #008000; font-weight: bold">&gt;</span>
  ...
  <span style="color: #408080; font-style: italic">&lt;!-- generate a full address from fields containing the component parts --&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;field</span> <span style="color: #7D9029">column=</span><span style="color: #BA2121">&quot;full_address&quot;</span> <span style="color: #7D9029">template=</span><span style="color: #BA2121">&quot;${en.street},${en.city},${en.zip}&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/entity&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="special-commands-for-dih">Special Commands for DIH</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can pass special commands to the DIH by adding any of the variables listed below to any row returned by any component:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">$skipDoc</dt>
<dd>
<p>Skip the current document; that is, do not add it to Solr. The value can be the string <code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">$skipRow</dt>
<dd>
<p>Skip the current row. The document will be added with rows from other entities. The value can be the string <code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">$deleteDocById</dt>
<dd>
<p>Delete a document from Solr with this ID. The value has to be the <code>uniqueKey</code> value of the document.</p>
</dd>
<dt class="hdlist1">$deleteDocByQuery</dt>
<dd>
<p>Delete documents from Solr using this query. The value must be a Solr Query.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>

<!-- Adds tags, if any -->
    <div class="tags">
        
    </div>

<!-- Adds nav links on each page -->
    
    
    <div class="scrollnav">
      
      <a class="btn btn-primary prev" href="https://solr.apache.org/guide/6_6/uploading-data-with-solr-cell-using-apache-tika.html">Uploading Data with Solr Cell using Apache Tika</a>
      
      
      <a class="btn btn-primary next" href="https://solr.apache.org/guide/6_6/updating-parts-of-documents.html">Updating Parts of Documents</a>
      
    </div>
    

</div>

<!-- Adds comments from Apache's Comment system -->

<div id="comments_thread">
</div>
<script type="text/javascript" src="https://comments.apache.org/show_comments.lua?site=solr-refguide&amp;style=css/comments.css&amp;page=uploading-structured-data-store-data-with-the-data-import-handler" async="true">
</script>
<noscript>
<iframe width="100%" height="500" src="https://comments.apache.org/iframe.lua?site=solr-refguide&amp;style=css/comments.css&amp;page=uploading-structured-data-store-data-with-the-data-import-handler"></iframe>
</noscript>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 Apache Software Foundation. All rights reserved. <br />
 Site Version: 6.6 <br />Site last generated: 2017-06-09 <br />
<p><img src="https://solr.apache.org/guide/6_6/images/solr-sunOnly-small.png" alt="Apache Solr"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
  </div>
  <!-- /.container -->
</div>

</body>

<!-- Mirrored from solr.apache.org/guide/6_6/uploading-structured-data-store-data-with-the-data-import-handler.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 26 Feb 2026 00:40:00 GMT -->
</html>
